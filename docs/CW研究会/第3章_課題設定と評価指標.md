# 第3章 課題設定と評価指標

本章では、日本語リポグラム生成タスクを形式的に定義し、そこから導かれる研究課題と評価指標を整理する。あわせて、本研究で用いるデータセットと制約タイプの概要も示す。

## 3.1 タスク定義

本研究で扱うタスクは、「与えられた日本語文と禁止文字集合に対して、その禁止文字を一切含まない日本語文を生成すること」である。入力としては、元となる日本語文 \(x\)（ことわざや例文など）と、禁止する仮名の集合 \(B\) を与える。禁止文字は、ひらがな1文字の集合として指定する場合（例：「い,さ」）に加え、「あ行」のように行単位で複数の仮名をまとめて禁止する場合も想定する。

出力文 \(y\) は、表記上あるいは読みレベルで禁止文字を一切含まないことが求められる。同時に、単に禁止文字を避けていれば良いのではなく、日本語として自然であり、元文の主要な意味内容を大きく損なっていないことが望ましい。より形式的には、文字ベース制約では「出力文 \(y\) に現れるどの文字も禁止集合 \(B\) に属さない」ことを、読みベース制約では「\(y\) を形態素解析して得られる読みの仮名列に現れるどの仮名も \(B\) に属さない」ことを条件として課す。

## 3.2 データセット概要

実験には、Tatoeba 由来の日本語例文コーパス（Tiedemann, 2020）などを元に構築した制約付きデータセットを用いる。まず、文字数 20〜60 程度で、ひらがなまたは漢字を含む文を条件として抽出し、ランダムに 200 文を選択してベース文集合を作成した。その後、各ベース文に対して複数の禁止文字集合 \(B\) を付与することで、制約付きパターンを展開し、最終的に約 500 パターンからなる評価用データセットを構成した。

このデータセットは、ことわざ中心の比較的短い文を対象としており、同一のベース文に対して複数の禁止文字集合を割り当てることで、多様な制約条件を同一基盤上で比較できるように設計している。

## 3.3 禁止文字セットと制約タイプ

禁止文字集合 \(B\) は、難易度の異なる複数の制約タイプから構成される。easy 条件では、「い」「さ」など頻度の中程度のひらがなを 1 文字だけ禁止する単音禁止を用いる。これは、語彙選択の自由度が比較的高く、リポグラムとしては実現しやすい制約である。

medium 条件では、「あ,い,う,え,お」や「か,き,く,け,こ」といった行単位の禁止を課す。行制約は同時に多数の仮名を禁止するため、使用可能な語彙が大きく制限され、自然な文を生成することが難しくなる。また、子音系列禁止のように、特定の子音に対応する仮名をまとめて禁止するパターンも含めて検証対象とする。

これらの制約タイプは、単音禁止から行禁止へと段階的に難易度が上がるように設計しており、どの程度の制約で oneshot と sequential の性能差が顕在化するかを観察することができる。本研究では単音禁止・行禁止・子音系列禁止といった複数のパターンを含めることで、難易度の異なるリポグラム生成条件を幅広くカバーしている。

## 3.4 評価指標

上記のタスクとデータセットに基づき、本研究では以下の指標を用いて生成結果を評価する。

- 制約遵守率（主指標）  
  生成文が禁止文字を一切含まない割合であり、リポグラムとして成立しているかどうかを判定する最重要の指標である。読みベース制約を採用する場合は、形態素解析と正規化を経て得られた読み列に対して判定を行う。

- 語彙置換率（Vocabulary Replacement Rate; VRR）  
  元文と生成文のトークン列を比較し、置き換わったトークンの割合を測る指標である。値が高いほど大きな言い換えが行われていることを意味し、意味保持とのトレードオフを捉えるために用いる。

- 語彙多様性や反復の指標（TTR・n-gram 反復率など）  
  TTR（Type-Token Ratio）は「異なり語数 ÷ 総語数」で定義され、語彙の多様さを測る指標である。n-gram 反復率は、同じ2語列や3語列（bi-gram / tri-gram）がどの程度繰り返されているかを測定し、不自然な反復や語彙の偏りを検出するために用いる。

- 実行時間・反復回数  
  1 文あたりの処理時間や、sequential における書き換えループの回数を記録し、制約遵守率とのトレードオフを評価する。

これらの指標を組み合わせることで、「制約をどれだけ厳格に守れるか」「元文の意味と自然さをどこまで保てるか」「実用時間内で動かせるか」という観点から、oneshot と sequential の二方式を多面的に比較する。
