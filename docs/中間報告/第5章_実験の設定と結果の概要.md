# 第5章 実験の設定と結果の概要

本章では、日本語リポグラム生成手法の評価に用いたデータセットと実験条件、および現時点で得られている定量的な結果とその解釈について述べる。

## 5.1 データセット

実験には、Tatoeba 由来の日本語例文コーパスを元に構築した制約付きデータセットを用いた。まず、文字数 20〜60 程度で、ひらがなまたは漢字を含む文を条件として抽出し、ランダムに 200 文を選択してベース文集合を作成した。その後、各ベース文に対して複数の禁止文字集合（banned_chars）を付与することで、制約付きパターンを展開し、最終的に 465 パターンからなる評価用データセット（dev_500）を構成した。

禁止文字集合は、単音禁止の easy 条件と行禁止の medium 条件に大別される。easy 条件では「い」「さ」「ら」など頻度の中程度の仮名を 1 文字だけ禁止し、medium 条件では「あ,い,う,え,お」や「か,き,く,け,こ」といった行単位の禁止を課した。各ベース文に対し、禁止セット内のいずれかのかなが表記に含まれる場合のみ、その組み合わせを 1 パターンとして採用し、1 文あたり最大 3 パターンまでに制限している。これにより、現実的な難易度の制約付き文集合を構成した。

## 5.2 実験条件と評価指標

モデルには OpenAI の GPT 系 LLM を用い、実験時点では gpt-4.1-nano を基準モデルとした。oneshot と sequential の双方について、温度やトップ確率などの生成パラメータは共通設定とし、各パターンに対して 1 回ずつ生成を行った。生成と評価は専用のバッチスクリプトにより自動化し、その結果を行ごとのレコードを持つ表形式データとして保存した。

評価指標としては、第3章で定義した読みベース制約遵守率を主指標としつつ、語彙置換率（VRR）、語彙多様性（TTR）、n-gram 反復率、実行時間を併用した。制約遵守率は、生成文の読み（カタカナをひらがなに正規化した文字列）に禁止かなが一切含まれない文の割合として定義し、VRRは元文と生成文のトークン列の差分から「どれだけ単語が置き換わったか」を近似的に測る指標である。TTRとn-gram反復率は生成文の多様性や反復傾向を捉える指標であり、実行時間は1文あたりの処理時間を通じて方式ごとの計算コストを評価するために用いた。主な実験条件と使用した指標の対応関係を表2にまとめる。

表2 実験条件と評価指標  
（ここに「項目／設定／主指標／補助指標」などを持つ表2が入る）

## 5.3 制約遵守率と方式比較

`dev_500` 全体で見ると、制約遵守率に関しては sequential が oneshot を大きく上回ることが明らかになった。reading ベースの成功率は、sequential が 91.6％（426/465）、oneshot が 12.5％（58/465）であり、逐次生成方式が一発生成方式を大きく上回ることが分かる。結果を図4に示す。

図4 生成方式別の制約遵守率  
（ここに oneshot と sequential の全体成功率を比較する棒グラフが入る）

さらに、制約タイプ別の成功率を図5に示す。とくに行禁止（medium）条件において、oneshot の成功率が大きく低下する一方で、sequential は高い成功率を維持しており、日本語の制約が厳しい条件ほど逐次生成方式の優位性が顕著になる傾向が見られた。また、各 id ごとに「どちらが成功したか」を比較したところ、sequential のみ成功したペアが 368（79.1％）、両方式とも成功または失敗の「同じ結果」が 97（20.9％）、oneshot のみが成功した例は 0 であった。対応のある t 検定でも、成功フラグ（0/1）の差は t≈42, p≪0.001 と、統計的に極めて有意な差が確認されている。

図5 制約タイプ別×生成方式別の制約遵守率  
（ここに easy / medium × oneshot / sequential の成功率を比較する棒グラフが入る）

## 5.4 VRR・TTR とエラー分析

次に、RQ2「制約遵守率を維持・向上させたうえで、元文の意味保持や自然さをどの程度保てるか」を検証するため、両方式とも制約を満たしたペア（58件）のみを対象に、VRR と TTR を比較した。図6は、このときの VRR と TTR の分布を示している。VRR については、oneshot の値が sequential よりも有意に高く（平均差≈0.33, p≪0.001）、oneshot の方がより大きな言い換えを行う傾向があることが分かる。一方で、TTR には有意な差が見られず、語彙多様性そのものは両方式で大きくは変わらない。このことから、逐次生成方式は制約を守りながら原文に近い表現にとどまりやすく、oneshot はより大胆な言い換えを行いやすいという性質が示唆される。

図6 VRR と TTR の散布図  
（ここに sequential / oneshot の VRR・TTR を示す散布図が入る）

RQ3「制約タイプや文長・文ジャンルによって両方式の得意・不得意はどのように変化するか」については、エラー分析を通じて定性的に検討した。禁止文字が頻出助詞（「は」「が」「を」など）に含まれる場合や、行禁止によって多数の仮名が一度に制約対象となる場合、あるいは読みベース制約により漢字語の読みが制限される場合などでは、両方式とも意味保持が難しくなることが確認された。図7に、代表的な成功例・失敗例をいくつか示す。oneshot では文全体を丸ごと言い換える過程で意味が原文から大きく逸脱してしまう例があり、sequential では局所的な修正を重ねるうちに文全体の統一感がやや損なわれる例が見られた。これらの事例は、第4章で述べた Web アプリケーション上で元文・制約・両方式の出力を並べて提示することで、今後の主観評価や改善策の検討に活用できる。

図7 成功例・失敗例（元文／制約／各方式の出力）  
（ここに代表的な成功例・失敗例を並べた図7が入る）

