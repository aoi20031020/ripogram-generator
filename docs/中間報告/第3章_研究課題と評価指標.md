# 第3章 研究課題と評価指標

本章では、本プロジェクトで扱うリポグラム生成タスクを形式的に定義し、そこから導かれる研究課題（Research Questions）と評価指標を整理する。これにより、第4章以降で述べる提案手法や実験設定が、どのような観点から評価されるべきかを明確にする。

## 3.1 タスク定義と研究課題

本研究で扱うタスクは、「与えられた日本語文と禁止文字集合に対して、その禁止文字を一切含まない日本語文を生成すること」である。入力としては、元となる日本語文（ことわざ、小説の一文、日常文など）と、禁止する文字の集合を与える。禁止文字は、ひらがな一文字の集合として指定する場合（例：「い,さ」）に加え、「あ行」のように行単位で複数の仮名をまとめて禁止する場合も想定する。アルゴリズムは、この入力に対して禁止文字を含まない新しい文を出力するが、出力文が単に禁止文字を避けていれば良いのではなく、日本語として自然であり、元文の意味内容を大きく損なっていない必要がある。

形式的には、入力文を \(x\)、禁止文字集合を \(B\)、出力文を \(y\) としたとき、次の条件を満たす \(y\) を生成することが目標となる。

1. 制約遵守（Constraint）：  
   出力文 \(y\) に含まれるすべての文字（あるいは読み）が、禁止集合 \(B\) に属さないこと。文字ベース制約では表記上の文字列、読みベース制約では形態素解析により得られた読みの仮名列に対してこの条件を課す。  
2. 意味保持（Semantic Preservation）：  
   元文 \(x\) と出力文 \(y\) の意味的類似度が十分に高いこと。完全な同義である必要はないが、元文が持つ主要な情報や含意が失われていないことが望ましい。  
3. 文法性・自然性（Fluency）：  
   出力文 \(y\) が日本語として自然に読めること。多少のスタイル変化（です・ます体から常体への変化など）は許容するが、意味が理解しづらいほどの文法破綻は避ける。

このタスク定義に基づき、本プロジェクトで特に検証したい研究課題は次の三点である。

- RQ1: 日本語リポグラム生成において、逐次生成方式（sequential）は一発生成方式（oneshot）に比べて、どの程度制約遵守率を改善できるか。  
- RQ2: 制約遵守率を維持・向上させたうえで、元文の意味保持や自然さをどの程度保てるか。その際、両方式の語彙置換率（VRR）や語彙多様性（TTR）にはどのような差が生じるか。  
- RQ3: 制約タイプ（単音禁止／行禁止など）や文長・文ジャンルの違いによって、両方式の得意・不得意はどのように変化するか。

## 3.2 評価指標と測定項目

上記の研究課題を検証するため、本研究では以下の指標を用いて生成結果を評価する。データセットや具体的な実験条件については第5章で詳述し、ここでは指標の役割に注目する。

- 主指標  
  - 制約遵守率（Constraint Satisfaction Rate）  
    - 読みベースで禁止かなを全く含まない生成文の割合。リポグラムとして成立しているかどうかを判定する最重要の指標であり、RQ1 の検証に対応する。  
- 補助指標（書き換えの性質・品質）  
  - 語彙置換率（Vocabulary Replacement Rate; VRR）  
    - 元文と生成文のトークン列を比較し、置き換わったトークンの割合を測る。値が高いほど大きな言い換えが行われていることを意味し、意味保持とのトレードオフを捉えるための指標である（RQ2）。  
  - 語彙多様性（Type-Token Ratio; TTR）  
    - 生成文におけるユニーク語彙の割合を測る。過度な語彙の繰り返しや、きわめて限定された語彙に偏った生成を検出するために用いる（RQ2）。  
  - n-gram 反復率  
    - 同一の bi-gram / tri-gram がどの程度繰り返されているかを測定し、不自然な反復や定型表現への偏りを評価する。  
  - 実行時間（Time per Output）  
    - 1 文あたりの処理時間を測定し、逐次生成方式と一発生成方式の計算コストの違いを把握する（RQ1 の実用性という側面）。

これらの指標を組み合わせることで、「制約をどれだけ厳格に守れるか」「どの程度まで元文の意味と自然さを保てるか」「実用時間内で動かせるか」といった観点から、二つの方式を多面的に比較する。

## 3.3 比較対象となる生成方式

以上のタスク定義と評価指標に基づき、本研究では「一発生成」と「逐次生成」という二つの方式を比較する。一発生成方式（oneshot）は、元文と禁止文字集合をまとめて LLM への入力とし、単一の応答としてリポグラム文を生成する方式である。プロンプト設計のみで制約を伝える一般的な利用形態に近く、対話型 LLM をそのまま用いた素朴なベースラインとして位置づけられる。

これに対して逐次生成方式（sequential）は、元文を文や文節に分割し、禁止文字を含むトークンを検出したうえで、その部分のみを文脈を考慮しながら順番に書き換えていく方式である。各ステップで読みベース制約を強くかけ直し、必要に応じて再試行を行うことで、制約遵守率の向上を狙った「リポグラム専用」の強力な方式とみなせる。両方式を同一のデータセット・同一のモデル条件のもとで評価することで、日本語リポグラム生成においてどのようなトレードオフが存在するのかを明らかにすることが、本章で整理した研究課題の核心である。
